<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VentyCalc â€“ Vape Session Planner</title>
<style>
html { background-color:#0b1220; }
body { margin:0; padding:12px; font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif; background-color:#0b1220; color:#e5e7eb; }

.container { max-width:960px; margin:0 auto; padding:15px 24px; display:flex; flex-wrap:wrap; gap:24px; }

.left-panel {
  flex:1;
  min-width:300px;
  display:flex;
  flex-direction:column;
  gap:6px;
  background-color: #1a2333;
  padding: 12px;
  border-radius:12px;
}

.right-panel {
  min-width:320px;
  max-width:380px;
  background-color:#1e293b;
  border-radius:12px;
  padding:14px;
  box-shadow: inset 0 0 10px rgba(56,189,248,0.2);
}

h1 { text-align:center; color:#38bdf8; margin:0 0 14px; }
label { display:block; margin-bottom:6px; font-weight:600; color:#cbd5f5; }
.slider-container, .select-container { margin-bottom:6px; }
.value-display { margin-left:6px; font-weight:700; color:#38bdf8; }
input[type="range"] { width:100%; cursor:pointer; accent-color:#38bdf8; }
select { width:100%; padding:6px 8px; border-radius:6px; border:1px solid #334155; background-color:#020617; color:#e5e7eb; font-size:0.95rem; }

.result, .weekly-plan, .joints-plan {
  margin-top:14px; padding:12px 16px; border-radius:12px;
  background-color:#020617; color:#bfdbfe;
  box-shadow: inset 0 0 14px rgba(56,189,248,0.18), 0 8px 20px rgba(0,0,0,0.4);
}

.result p, .weekly-plan p, .joints-plan p { margin:6px 0; font-size:0.95rem; line-height:1.2; }
.highlight { font-weight:700; color:#93c5fd; }
.warning { margin-top:5px; font-weight:700; color:#fb7185; animation:pulse 1.2s infinite; }
@keyframes pulse {0%{opacity:1;}50%{opacity:0.35;}100%{opacity:1;}}
.summary-container { display:flex; gap:12px; }
.summary-left, .summary-right { flex:1; }
.savings { color:#00ff7f; font-weight:700; animation: neonPulse 1s infinite; white-space: nowrap; }
.spare-caps { color:#00ff7f; font-weight:700; animation: neonPulse 1s infinite; }
@keyframes neonPulse { 0%{opacity:1;}50%{opacity:0.35;}100%{opacity:1;} }
footer { margin-top:10px; text-align:center; font-size:0.8rem; color:#64748b; }
</style>
</head>
<body>

<h1>VentyCalc â€“ Vape Session Planner</h1>

<div class="container">

<div class="left-panel">

  <div class="slider-container">
    <label>Capsule Weight (g): <span class="value-display" id="capsuleVal">0.10</span></label>
    <input type="range" id="capsule" min="0.10" max="0.15" step="0.01" value="0.10">
  </div>

  <div class="slider-container">
    <label>Temperature (Â°C): <span class="value-display" id="tempVal">170</span></label>
    <input type="range" id="temp" min="170" max="210" step="1" value="170">
  </div>

  <div class="slider-container">
    <label>Total Herb Available (g): <span class="value-display" id="herbVal">14.0</span></label>
    <input type="range" id="herbTotal" min="0.5" max="28" step="0.5" value="14">
  </div>

  <div class="slider-container">
    <label>Price of Herbs (Â£ / $ / â‚¬): <span class="value-display" id="priceVal">100</span></label>
    <input type="range" id="pricePerOunce" min="20" max="240" step="5" value="100">
  </div>

  <div class="select-container">
    <label>Stem / Stork Weight (% of total):</label>
    <select id="storkPercent">
      <option value="0" selected>0% (vape everything)</option>
      <option value="0.05">5%</option>
      <option value="0.10">10%</option>
      <option value="0.15">15%</option>
    </select>
    <div id="storkWarning" class="warning" style="display:block;">
      Select stem/stork percentage unless you plan to vape them you filthy beast, where's your standards? &lt;3
    </div>
  </div>

  <div class="select-container">
    <label>Airflow Setting:</label>
    <select id="airflow">
      <option value="0.85">Low</option>
      <option value="1" selected>Medium</option>
      <option value="1.15">High</option>
    </select>
  </div>

  <div class="result summary-container" aria-live="polite">
    <div class="summary-left">
      <p>Estimated Draws per Capsule: <span id="draws">8</span></p>
      <p>Grams per Draw: <span id="gramsPerDraw">0.05</span> g</p>
      <p id="totalCapsulesLabel">Total Capsules Available: <span id="totalCapsules">0</span></p>
      <p>Total Herbs Minus Stems: <span id="usableHerb">0.00</span> g</p>
      <p id="capsShortfall" class="warning" style="display:none;"></p>
    </div>
    <div class="summary-right">
      <p>Cost per Gram: <span id="costPerGram">0.00</span></p>
      <p>Cost per Capsule: <span id="costPerCapsule">0.00</span></p>
      <p>Cost per Draw: <span id="costPerDraw">0.00</span></p>
      <p>Cost per Workday Weeks: <span id="costWorkday">0.00</span></p>
      <p>Cost per Single Weekends: <span id="costWeekend">0.00</span></p>
      <p>Total Cost Weeks Combined: <span id="costTotal">0.00</span></p>
      <p>Cost of Wasted Stems: <span id="costStems">0.00</span></p>
    </div>
  </div>

</div>

<div class="right-panel">
  <h2 style="text-align:center;color:#38bdf8;margin-top:0;">Weekly Planning</h2>

  <label>Capsules per Workday Session:</label>
  <select id="weekdaySessions">
    <option value="0" selected>0</option>
    <option value="1">1</option>
    <option value="2">2</option>
    <option value="3">3</option>
    <option value="4">4</option>
    <option value="5">5</option>
  </select>

  <label>Capsules per Weekend Session:</label>
  <select id="weekendSessions">
    <option value="0">0</option>
    <option value="1">1</option>
    <option value="2">2</option>
    <option value="3">3</option>
    <option value="4">4</option>
    <option value="5">5</option>
    <option value="6">6</option>
    <option value="7">7</option>
    <option value="8">8</option>
    <option value="9">9</option>
    <option value="10">10</option>
  </select>

  <label>Total Weeks:</label>
  <select id="totalWeeks">
    <option value="1" selected>1</option>
    <option value="2">2</option>
    <option value="3">3</option>
    <option value="4">4</option>
  </select>

  <div class="weekly-plan">
    <p>Total Capsules per Workday Weeks: <span id="totalCapsulesWorkday">0</span></p>
    <p>Total Capsules per Single Weekends: <span id="totalCapsulesWeekend">0</span></p>
    <p>Total Capsules per Week: <span id="totalCapsulesWeek">0</span></p>
    <p id="spareCapsules" class="spare-caps" style="display:none;"></p>
    <p>Total Herb Used on Workday Weeks: <span id="weekdayHerb">0.00</span> g</p>
    <p>Total Herb Used on Single Weekends: <span id="weekendHerb">0.00</span> g</p>
    <p>Total Herb Used Weeks Combined: <span id="weeklyTotal">0.00</span> g</p>
  </div>

  <div class="joints-plan">
    <h3 style="color:#38bdf8;margin-top:0;">Approx. Cost Comparison vs. Rolling</h3>
    <p>Based on usable herb, you could roll approximately <span id="estimatedJoints">0</span> joints (0.3â€¯g each)</p>
    <p class="cost-line">Cost per Joint: <span id="costPerJoint">0.00</span></p>
    <p class="cost-line">Equivalent Cost for Capsules to match joints: <span id="capsulesForJointsCost">0.00</span></p>
    <p class="cost-line">Savings by using DryVape Capsules vs joints: <span id="capsulesSavings" class="savings"></span></p>
  </div>

</div>

</div>

<footer>
Â© 2026 VentyCalc â€” Kitchenspoon 2026 Â· <strong>R1.48</strong>
</footer>

<script>
// R1.48: Immutable MathEngine + updateDashboard (cost outputs now numeric only)
const capsuleSlider=document.getElementById('capsule');
const tempSlider=document.getElementById('temp');
const herbSlider=document.getElementById('herbTotal');
const priceSlider=document.getElementById('pricePerOunce');
const airflowSelect=document.getElementById('airflow');
const storkSelect=document.getElementById('storkPercent');
const storkWarning=document.getElementById('storkWarning');
const weekdaySelect=document.getElementById('weekdaySessions');
const weekendSelect=document.getElementById('weekendSessions');
const totalWeeksSelect=document.getElementById('totalWeeks');
const totalCapsulesLabel=document.getElementById('totalCapsulesLabel');
const spareCapsulesOutput=document.getElementById('spareCapsules');
const capsShortfall=document.getElementById('capsShortfall');
const BASE_DRAWS=8;
const jointWeight=0.3;

const MathEngine = Object.freeze({
  calcUsableHerb: (totalHerb, stork) => totalHerb*(1-stork),
  calcTotalCapsules: (usableHerb, capsuleWeight) => Math.floor(usableHerb/capsuleWeight),
  calcDraws: (baseDraws, temp, airflow) => Math.max(1, Math.ceil((baseDraws-(temp-170)/10)/airflow)),
  calcGramsPerDraw: (capsuleWeight, draws) => capsuleWeight/draws,
  calcWeeklyCapsules: (weekdayCaps, weekendCaps, weeks) => ({workday: weekdayCaps*5*weeks, weekend: weekendCaps*2*weeks, total: weekdayCaps*5*weeks + weekendCaps*2*weeks}),
  calcHerbUsed: (capsuleWeight, weeklyCaps) => ({workday: capsuleWeight*weeklyCaps.workday, weekend: capsuleWeight*weeklyCaps.weekend, total: capsuleWeight*weeklyCaps.total}),
  calcCostPerGram: (price, totalHerb) => price/totalHerb,
  calcCostPerCapsule: (price, totalCapsules) => price/totalCapsules,
  calcCostPerDraw: (gramsPerDraw, costPerGram) => gramsPerDraw*costPerGram,
  calcJoints: (usableHerb, jointWeight) => Math.floor(usableHerb/jointWeight),
  calcCostPerJoint: (price, totalJoints) => price/totalJoints,
  calcCapsulesForJoints: (capsuleCost, numJoints) => capsuleCost*numJoints,
  calcSavings: (bagCost, capsulesCost) => ({money: bagCost - capsulesCost, percent: ((bagCost - capsulesCost)/bagCost)*100})
});

function updateDashboard(){
  const inputs = {
    capsule: parseFloat(capsuleSlider.value),
    temp: parseInt(tempSlider.value),
    herb: parseFloat(herbSlider.value),
    price: parseFloat(priceSlider.value),
    airflow: parseFloat(airflowSelect.value),
    stork: parseFloat(storkSelect.value),
    weeks: parseInt(totalWeeksSelect.value),
    weekdayCaps: parseInt(weekdaySelect.value),
    weekendCaps: parseInt(weekendSelect.value)
  };

  capsuleVal.textContent=inputs.capsule.toFixed(2);
  tempVal.textContent=inputs.temp;
  herbVal.textContent=inputs.herb.toFixed(1);
  priceVal.textContent=inputs.price;

  const usable = MathEngine.calcUsableHerb(inputs.herb, inputs.stork);
  usableHerb.textContent = usable.toFixed(2);
  storkWarning.style.display = inputs.stork===0?'block':'none';

  const draws = MathEngine.calcDraws(BASE_DRAWS, inputs.temp, inputs.airflow);
  document.getElementById('draws').textContent = draws;
  gramsPerDraw.textContent = MathEngine.calcGramsPerDraw(inputs.capsule, draws).toFixed(3);

  const totalCapsAvailable = MathEngine.calcTotalCapsules(usable, inputs.capsule);
  totalCapsules.textContent = totalCapsAvailable;

  const weeklyCaps = MathEngine.calcWeeklyCapsules(inputs.weekdayCaps, inputs.weekendCaps, inputs.weeks);
  totalCapsulesWorkday.textContent = weeklyCaps.workday;
  totalCapsulesWeekend.textContent = weeklyCaps.weekend;
  totalCapsulesWeek.textContent = weeklyCaps.total;

  if(weeklyCaps.total > totalCapsAvailable){
    totalCapsulesLabel.style.color='#fb7185';
    totalCapsulesLabel.style.animation='pulse 1.2s infinite';
    capsShortfall.style.display='block';
    capsShortfall.textContent=`Short by ${weeklyCaps.total-totalCapsAvailable} capsule(s)`;
  } else {
    totalCapsulesLabel.style.color='';
    totalCapsulesLabel.style.animation='';
    capsShortfall.style.display='none';
  }

  const spare = totalCapsAvailable - weeklyCaps.total;
  spareCapsulesOutput.style.display = spare>0?'block':'none';
  spareCapsulesOutput.textContent = `Spare Capsules: ${Math.floor(spare)}`;

  const costPerGramValue = MathEngine.calcCostPerGram(inputs.price, inputs.herb);
  costPerGram.textContent = costPerGramValue.toFixed(2);
  const costPerCapsuleValue = MathEngine.calcCostPerCapsule(inputs.price, totalCapsAvailable);
  costPerCapsule.textContent = costPerCapsuleValue.toFixed(2);
  costPerDraw.textContent = MathEngine.calcCostPerDraw(inputs.capsule/draws, costPerGramValue).toFixed(2);

  const herbUsed = MathEngine.calcHerbUsed(inputs.capsule, weeklyCaps);
  weekdayHerb.textContent = herbUsed.workday.toFixed(2);
  weekendHerb.textContent = herbUsed.weekend.toFixed(2);
  weeklyTotal.textContent = herbUsed.total.toFixed(2);

  costWorkday.textContent = (herbUsed.workday*costPerGramValue).toFixed(2);
  costWeekend.textContent = (herbUsed.weekend*costPerGramValue).toFixed(2);
  costTotal.textContent = (herbUsed.total*costPerGramValue).toFixed(2);
  costStems.textContent = (inputs.herb*inputs.stork*costPerGramValue).toFixed(2);

  const estJoints = MathEngine.calcJoints(usable, jointWeight);
  document.getElementById('estimatedJoints').textContent = estJoints;
  const totalJoints = Math.floor(inputs.herb/jointWeight);
  const costPerJoint = MathEngine.calcCostPerJoint(inputs.price, totalJoints);
  document.getElementById('costPerJoint').textContent = costPerJoint.toFixed(2);

  const capsulesForJointsCost = MathEngine.calcCapsulesForJoints(costPerCapsuleValue, estJoints);
  document.getElementById('capsulesForJointsCost').textContent = capsulesForJointsCost.toFixed(2);

  const savings = MathEngine.calcSavings(inputs.price, capsulesForJointsCost);
  capsulesSavings.textContent = `${savings.money.toFixed(2)} ðŸ™‚ (${savings.percent.toFixed(0)}%)`;
}

document.querySelectorAll('input,select').forEach(el=>el.addEventListener('input',updateDashboard));
updateDashboard();
</script>

</body>
</html>
